{"version":3,"file":"index.module.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport './index.scss';\n\nexport default class extends Controller {\n  static values = {\n    mode: String\n  };\n\n  get groups() {\n    return this.scope.findAllElements('[data-form-group-id]');\n  }\n\n  get togglers() {\n    return this.context.bindingObserver.bindings\n               .filter(binding => binding.action.methodName == 'toggle')\n               .map(binding => binding.action.element);\n  }\n\n  connect() {\n    this.enableAnim(false);\n    this.togglers.forEach(toggler => this.toggleBy(toggler));\n    setTimeout(() => this.enableAnim(true), 200);\n  }\n\n  enableAnim(enabled) {\n    this.groups.forEach(group => {\n      if (enabled) {\n        group.classList.remove('st-form-groups--disable-anim')\n      } else {\n        group.classList.add('st-form-groups--disable-anim')\n      }\n    });\n  }\n\n  toggle(e) {\n    this.toggleBy(e.target);\n  }\n\n  toggleBy(elem) {\n    let method = this.toggleMethod();\n    this.groups.forEach(group => method(group, false));\n    this.findGroups(elem).forEach(group => method(group, true));\n  }\n\n  toggleMethod() {\n    if (this.modeValue == 'disabled') {\n      return this.toggleDisabled.bind(this);\n    } else {\n      return this.toggleVisible.bind(this);\n    }\n  }\n\n  toggleVisible(group, visible) {\n    if (visible) {\n      group.style.display = '';\n      group.classList.add('st-form-groups--fade-in');\n    } else {\n      group.style.display = 'none';\n      group.classList.remove('st-form-groups--fade-in');\n    }\n  }\n\n  toggleDisabled(group, enabled) {\n    this.inputElements(group).forEach(elem => elem.disabled = !enabled);\n  }\n\n  inputElements(group) {\n    return group.querySelectorAll('input, select, textarea, button')\n  }\n\n  findGroups(target) {\n    let id = this.getGroupID(target);\n    if (!id) {\n      return [];\n    } else {\n      return this.groups.filter(group => this.parseJSON(group.getAttribute('data-form-group-id')).includes(id));\n    }\n  }\n\n  getGroupID(target) {\n    if (target.matches('select')) {\n      return target.options[target.selectedIndex].value;\n    } else if (target.matches('input[type=checkbox]')) {\n      return target.checked;\n    } else if (target.matches('input[type=radio]')) {\n      let checked = this.scope.findElement(`input[type=radio][name=\"${target.name}\"]:checked`);\n      return checked ? checked.value : null;\n    }\n  }\n\n  parseJSON(ids) {\n    try {\n      return [].concat(JSON.parse(ids));\n    } catch(e) {\n      return [].concat(ids);\n    }\n  }\n}\n"],"names":["Controller","groups","scope","findAllElements","togglers","context","bindingObserver","bindings","filter","binding","action","methodName","map","element","connect","this","enableAnim","forEach","toggler","toggleBy","setTimeout","enabled","group","classList","remove","add","toggle","e","target","elem","method","toggleMethod","findGroups","modeValue","toggleDisabled","bind","toggleVisible","visible","style","display","inputElements","disabled","querySelectorAll","id","getGroupID","parseJSON","getAttribute","includes","matches","options","selectedIndex","value","checked","findElement","name","ids","concat","JSON","parse","values","mode","String"],"mappings":"gEAG6BA,EAKvBC,aACF,YAAYC,MAAMC,gBAAgB,wBAGhCC,eACF,YAAYC,QAAQC,gBAAgBC,SACxBC,OAAOC,GAAwC,UAA7BA,EAAQC,OAAOC,YACjCC,IAAIH,GAAWA,EAAQC,OAAOG,SAG5CC,UACEC,KAAKC,YAAW,GAChBD,KAAKX,SAASa,QAAQC,GAAWH,KAAKI,SAASD,IAC/CE,WAAW,IAAML,KAAKC,YAAW,GAAO,KAG1CA,WAAWK,GACTN,KAAKd,OAAOgB,QAAQK,IACdD,EACFC,EAAMC,UAAUC,OAAO,gCAEvBF,EAAMC,UAAUE,IAAI,kCAK1BC,OAAOC,GACLZ,KAAKI,SAASQ,EAAEC,QAGlBT,SAASU,GACP,IAAIC,EAASf,KAAKgB,eAClBhB,KAAKd,OAAOgB,QAAQK,GAASQ,EAAOR,GAAO,IAC3CP,KAAKiB,WAAWH,GAAMZ,QAAQK,GAASQ,EAAOR,GAAO,IAGvDS,eACE,MAAsB,YAAlBhB,KAAKkB,eACKC,eAAeC,KAAKpB,WAEpBqB,cAAcD,KAAKpB,MAInCqB,cAAcd,EAAOe,GACfA,GACFf,EAAMgB,MAAMC,QAAU,GACtBjB,EAAMC,UAAUE,IAAI,6BAEpBH,EAAMgB,MAAMC,QAAU,OACtBjB,EAAMC,UAAUC,OAAO,4BAI3BU,eAAeZ,EAAOD,GACpBN,KAAKyB,cAAclB,GAAOL,QAAQY,GAAQA,EAAKY,UAAYpB,GAG7DmB,cAAclB,GACZ,OAAOA,EAAMoB,iBAAiB,mCAGhCV,WAAWJ,GACT,IAAIe,EAAK5B,KAAK6B,WAAWhB,GACzB,OAAKe,OAGS1C,OAAOO,OAAOc,GAASP,KAAK8B,UAAUvB,EAAMwB,aAAa,uBAAuBC,SAASJ,IAF9F,GAMXC,WAAWhB,GACT,GAAIA,EAAOoB,QAAQ,UACjB,OAAOpB,EAAOqB,QAAQrB,EAAOsB,eAAeC,SACnCvB,EAAOoB,QAAQ,wBACxB,OAAOpB,EAAOwB,WACLxB,EAAOoB,QAAQ,qBAAsB,CAC9C,IAAII,EAAUrC,KAAKb,MAAMmD,uCAAuCzB,EAAO0B,mBACvE,OAAOF,EAAUA,EAAQD,MAAQ,MAIrCN,UAAUU,GACR,IACE,MAAO,GAAGC,OAAOC,KAAKC,MAAMH,IAC5B,MAAM5B,GACN,MAAO,GAAG6B,OAAOD,OA1FdI,OAAS,CACdC,KAAMC"}