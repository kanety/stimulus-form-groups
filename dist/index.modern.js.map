{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport './index.scss';\n\nexport default class extends Controller {\n  static values = {\n    mode: String\n  };\n\n  get groups() {\n    return this.scope.findAllElements('[data-form-group-id]');\n  }\n\n  get togglers() {\n    return this.context.bindingObserver.bindings\n               .filter(binding => binding.action.methodName == 'toggle')\n               .map(binding => binding.action.element);\n  }\n\n  connect() {\n    this.enableAnim(false);\n    this.togglers.forEach(toggler => this.toggleBy(toggler));\n    setTimeout(() => this.enableAnim(true), 200);\n  }\n\n  enableAnim(enabled) {\n    this.groups.forEach(group => {\n      if (enabled) {\n        group.classList.remove('st-form-groups--disable-trans')\n      } else {\n        group.classList.add('st-form-groups--disable-trans')\n      }\n    });\n  }\n\n  toggle(e) {\n    this.toggleBy(e.target);\n  }\n\n  toggleBy(elem) {\n    let method = this.toggleMethod();\n    this.groups.forEach(group => method(group, false));\n    this.findGroups(elem).forEach(group => method(group, true));\n  }\n\n  toggleMethod() {\n    if (this.modeValue == 'disabled') {\n      return this.toggleDisabled.bind(this);\n    } else {\n      return this.toggleVisible.bind(this);\n    }\n  }\n\n  toggleVisible(group, visible) {\n    if (visible) {\n      group.style.visibility = '';\n      group.style.overflow = '';\n      group.style.height = group.scrollHeight + 'px';\n      group.classList.add('st-form-groups__group--visible');\n    } else {\n      group.style.visibility = 'hidden';\n      group.style.overflow = 'hidden';\n      group.style.height = '0px';\n      group.classList.remove('st-form-groups__group--visible');\n    }\n  }\n\n  toggleDisabled(group, enabled) {\n    this.inputElements(group).forEach(elem => elem.disabled = !enabled);\n  }\n\n  inputElements(group) {\n    return group.querySelectorAll('input, select, textarea, button')\n  }\n\n  findGroups(target) {\n    let id = this.getGroupID(target);\n    if (!id) {\n      return [];\n    } else {\n      return this.groups.filter(group => this.parseJSON(group.getAttribute('data-form-group-id')).includes(id));\n    }\n  }\n\n  getGroupID(target) {\n    if (target.matches('select')) {\n      return target.options[target.selectedIndex].value;\n    } else if (target.matches('input[type=checkbox]')) {\n      return target.checked;\n    } else if (target.matches('input[type=radio]')) {\n      let checked = this.scope.findElement(`input[type=radio][name=\"${target.name}\"]:checked`);\n      return checked ? checked.value : null;\n    }\n  }\n\n  parseJSON(ids) {\n    try {\n      return [].concat(JSON.parse(ids));\n    } catch(e) {\n      return [].concat(ids);\n    }\n  }\n}\n"],"names":["Controller","groups","scope","findAllElements","togglers","context","bindingObserver","bindings","filter","binding","action","methodName","map","element","connect","this","enableAnim","forEach","toggler","toggleBy","setTimeout","enabled","group","classList","remove","add","toggle","e","target","elem","method","toggleMethod","findGroups","modeValue","toggleDisabled","bind","toggleVisible","visible","style","visibility","overflow","height","scrollHeight","inputElements","disabled","querySelectorAll","id","getGroupID","parseJSON","getAttribute","includes","matches","options","selectedIndex","value","checked","findElement","name","ids","concat","JSON","parse","values","mode","String"],"mappings":"gEAG6BA,EAKvBC,aACF,YAAYC,MAAMC,gBAAgB,wBAGhCC,eACF,YAAYC,QAAQC,gBAAgBC,SACxBC,OAAOC,GAAwC,UAA7BA,EAAQC,OAAOC,YACjCC,IAAIH,GAAWA,EAAQC,OAAOG,SAG5CC,UACEC,KAAKC,YAAW,GAChBD,KAAKX,SAASa,QAAQC,GAAWH,KAAKI,SAASD,IAC/CE,WAAW,IAAML,KAAKC,YAAW,GAAO,KAG1CA,WAAWK,GACTN,KAAKd,OAAOgB,QAAQK,IACdD,EACFC,EAAMC,UAAUC,OAAO,iCAEvBF,EAAMC,UAAUE,IAAI,mCAK1BC,OAAOC,GACLZ,KAAKI,SAASQ,EAAEC,QAGlBT,SAASU,GACP,IAAIC,EAASf,KAAKgB,eAClBhB,KAAKd,OAAOgB,QAAQK,GAASQ,EAAOR,GAAO,IAC3CP,KAAKiB,WAAWH,GAAMZ,QAAQK,GAASQ,EAAOR,GAAO,IAGvDS,eACE,MAAsB,YAAlBhB,KAAKkB,eACKC,eAAeC,KAAKpB,WAEpBqB,cAAcD,KAAKpB,MAInCqB,cAAcd,EAAOe,GACfA,GACFf,EAAMgB,MAAMC,WAAa,GACzBjB,EAAMgB,MAAME,SAAW,GACvBlB,EAAMgB,MAAMG,OAASnB,EAAMoB,aAAe,KAC1CpB,EAAMC,UAAUE,IAAI,oCAEpBH,EAAMgB,MAAMC,WAAa,SACzBjB,EAAMgB,MAAME,SAAW,SACvBlB,EAAMgB,MAAMG,OAAS,MACrBnB,EAAMC,UAAUC,OAAO,mCAI3BU,eAAeZ,EAAOD,GACpBN,KAAK4B,cAAcrB,GAAOL,QAAQY,GAAQA,EAAKe,UAAYvB,GAG7DsB,cAAcrB,GACZ,OAAOA,EAAMuB,iBAAiB,mCAGhCb,WAAWJ,GACT,IAAIkB,EAAK/B,KAAKgC,WAAWnB,GACzB,OAAKkB,OAGS7C,OAAOO,OAAOc,GAASP,KAAKiC,UAAU1B,EAAM2B,aAAa,uBAAuBC,SAASJ,IAF9F,GAMXC,WAAWnB,GACT,GAAIA,EAAOuB,QAAQ,UACjB,OAAOvB,EAAOwB,QAAQxB,EAAOyB,eAAeC,SACnC1B,EAAOuB,QAAQ,wBACxB,OAAOvB,EAAO2B,WACL3B,EAAOuB,QAAQ,qBAAsB,CAC9C,IAAII,EAAUxC,KAAKb,MAAMsD,YAAa,2BAA0B5B,EAAO6B,kBACvE,OAAOF,EAAUA,EAAQD,MAAQ,MAIrCN,UAAUU,GACR,IACE,MAAO,GAAGC,OAAOC,KAAKC,MAAMH,IAC5B,MAAM/B,GACN,MAAO,GAAGgC,OAAOD,OA9FdI,OAAS,CACdC,KAAMC"}